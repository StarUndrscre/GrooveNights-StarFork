<ActorFrame InitCommand="%function(self) 
if GAMESTATE:GetEnv('Vibrate') == 'On' then
	self:vibrate();
	end
end">
	<children>
<ActorFrame InitCommand="%EvaluationInit" FirstUpdateCommand="%Evaluation" />

<Layer Type="Quad"
OnCommand="%function(self) self:diffusealpha(0); InitScreen('ScreenEvaluation'); end"
/>

<!--Mask the LifeGraph so you can change its colour-->
<Layer
	Type="Quad"
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_1)"
	OnCommand="@'x,SCREEN_CENTER_X-155;y,SCREEN_CENTER_Y+151;zoomx,272.5;zoomy,40;diffuse,'..PlayerColor(PLAYER_1)..';'"
/>
<Layer
	Type="Quad"
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_1)"
	OnCommand="x,SCREEN_CENTER_X-155;y,SCREEN_CENTER_Y+151;zoomx,272.5;zoomy,41;ztest,1;diffuse,0,0,0,1;"
/>

<Layer
	Type="Quad"
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_2)"
	OnCommand="@'x,SCREEN_CENTER_X+155;y,SCREEN_CENTER_Y+151;zoomx,272.5;zoomy,40;diffuse,'..PlayerColor(PLAYER_2)..';'"
/>
<Layer
	Type="Quad"
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_2)"
	OnCommand="x,SCREEN_CENTER_X+155;y,SCREEN_CENTER_Y+151;zoomx,272.5;zoomy,41;ztest,1;diffuse,0,0,0,1;"
/>

<!--Overlay the lifegraph with a dark quad for text messages-->
<Layer Type="Quad" OnCommand="x,SCREEN_CENTER_X-156;y,SCREEN_CENTER_Y+161;diffuse,0,0,0,0;zoomx,274;zoomy,15;"
GraphAwardP1MessageCommand="%function(self) self:diffusealpha(0.75); self:draworder(0); if GAMESTATE:PlayerUsingBothSides(PLAYER_1) then self:addx(-12); end end"
/>
<Layer Type="Quad" OnCommand="x,SCREEN_CENTER_X-156;y,SCREEN_CENTER_Y+168;diffuse,0,0,0,1;zoomx,274;zoomy,2;"/>
<Layer Type="Quad" OnCommand="x,SCREEN_CENTER_X-156;y,SCREEN_CENTER_Y+172;diffuse,0,0,0,1;zoomx,274;zoomy,2;"/>

<Layer Type="Quad" OnCommand="x,SCREEN_CENTER_X+154;y,SCREEN_CENTER_Y+161;diffuse,0,0,0,0;zoomx,274;zoomy,15;"
GraphAwardP2MessageCommand="%function(self) self:diffusealpha(0.75); self:draworder(0); if GAMESTATE:PlayerUsingBothSides(PLAYER_2) then self:addx(8); end end"
/>
<Layer Type="Quad" OnCommand="x,SCREEN_CENTER_X+154;y,SCREEN_CENTER_Y+168;diffuse,0,0,0,1;zoomx,274;zoomy,2;"/>
<Layer Type="Quad" OnCommand="x,SCREEN_CENTER_X+154;y,SCREEN_CENTER_Y+172;diffuse,0,0,0,1;zoomx,274;zoomy,2;"


<!--Move P2's PerDifficulty Award since it's shared between players and aligns left for both-->
	<BitmapText
	Text=""
	File="_eurostile blue glow"
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_2)"
	InitCommand="%function(self)
	self:x(SCREEN_CENTER_X);
	self:y(SCREEN_CENTER_Y);
	end"
	PerDifficultyAwardMessageCommand="%function(self)
	self:hibernate(0.01);
	self:queuecommand('Go');
	end"
	GoCommand="%function(self)
	SCREENMAN:GetTopScreen():GetChild('PerDifficultyAwardP2'):addx(-12-gnAwardWidthP2/2);
	SCREENMAN:GetTopScreen():GetChild('PerDifficultyAwardP2'):addy(1);
	end"
	/>
		
		
<!--Show a special THING if either player quads a song with a certain name as their card profile-->
<!-- Stupid: SOUND:DimMusic will not work when called from an init or oncommand so we must queue our own -->
<Layer Type="Quad"
		InitCommand="zoom,SCREEN_WIDTH;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;diffuse,0,0,0,0;queuecommand,Silence;"        
        OnCommand="%function(self) DoEasterEgg('QuadAward', { Actor = self, Layer = 'Dimmer' }) end"
		SilenceCommand="%function(self) DoEasterEgg('QuadAward', { Layer = 'Silence' } ) end"
/>

<Layer Type="Quad"
    InitCommand="draworder,0;diffusealpha,0;"
    OnCommand="%function(self) DoEasterEgg('QuadAward', { Actor = self, Layer = 'Video' }) end"
/>
		
	<!--Restart the song on event mode if you pressed the menu button-->
		<BitmapText
		Text=""
		File="_eurostile blue glow"
		Condition="GAMESTATE:IsEventMode() and MenuButtonGiveUp() and not gnNoRestart and not GAMESTATE:IsCourseMode()"
		InitCommand="%function(self)
		if gnSongElapsedPercent > gnLowestRestartPercent and gnSongElapsedPercent < gnHighestRestartPercent then
			SCREENMAN:SetNewScreen('ScreenStage');
			end
		end"
		/>
			
	
		<ActorFrame InitCommand="x,SCREEN_CENTER_X+89">
			<children>
	<!--Total PlayTime-->
			<BitmapText
				Text=""
				File="_eurostile blue glow"
				Condition="PlayTimeEnabled()"
				InitCommand="@'diffuse,'..LabelColor()"
				OnCommand="%function(self)
					self:x(-112);
					self:y(SCREEN_BOTTOM-10);
					self:zoom(0.6);
					self:shadowlength(0);
					self:horizalign('Right');
					self:settext('Total PlayTime');	
					self:queuecommand('Blink');
				end"
				BlinkCommand="sleep,1;diffusealpha,0.5;sleep,1;diffusealpha,1;queuecommand,Blink"
			/>
	<!--Total PlayTime Variables-->
			<BitmapText
				Text=""
				File="_eurostile blue glow"
				Condition="PlayTimeEnabled()"
				InitCommand="%function(self)  self:x(-102) self:zoom(0.6); self:shadowlength(0) self:draworder(10000); self:y(SCREEN_BOTTOM-10); self:horizalign('left'); end"
				OnCommand="%function(self)
				if gnPlaySec == nil then
					gnPlaySec = 0;
					gnPlayMin = 0;
					gnPlayHour = 0;
					end
				if gnPlaySec >= 60 then
					gnPlaySec = gnPlaySec - 60;
					gnPlayMin = gnPlayMin + 1;
					end
				if gnPlayMin >= 60 then
					gnPlayMin = gnPlayMin - 60;
					gnPlayHour = gnPlayHour + 1;
					end

				if gnPlaySec < 10 then
					gnPlaySecText = '0'..gnPlaySec
					else
					gnPlaySecText = ''..gnPlaySec
					end
				if gnPlayMin < 10 then
					gnPlayMinText = '0'..gnPlayMin
					else
					gnPlayMinText = ''..gnPlayMin
					end
				if gnPlayHour < 10 then
					gnPlayHourText = '0'..gnPlayHour
					else
					gnPlayHourText = ''..gnPlayHour
					end
					
				self:settext(gnPlayHourText..':'..gnPlayMinText..':'..gnPlaySecText);
				self:queuecommand('Blink');
				end"
				BlinkCommand="sleep,1;diffusealpha,0.5;sleep,1;diffusealpha,1;queuecommand,Blink"
				
			/>
	<!--Song Count-->
			<BitmapText
				Text=""
				File="_eurostile blue glow"
				Condition="PlayTimeEnabled()"
				InitCommand="%function(self)  self:x(-32) self:zoom(0.6); self:shadowlength(0) self:draworder(10000); self:y(SCREEN_BOTTOM-10); self:horizalign('left'); end"
				OnCommand="%function(self)
				if gnSongCount == nil then
					gnSongCount = 0;
					end
	
				if gnSongCount == 1 then
					self:settext('('..gnSongCount..' Song)');
					else
					self:settext('('..gnSongCount..' Songs)');
					end	
				self:queuecommand('Blink');
				end"
				BlinkCommand="sleep,1;diffusealpha,0.5;sleep,1;diffusealpha,1;queuecommand,Blink"
			/>
			</children>
		</ActorFrame>
			
	<!--Cull the Mods-->
	<BitmapText Font="_eurostile normal" Text=""
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_1)"
	InitCommand="hibernate,0.1;vertalign,top;horizalign,center;WrapWidthPixels,254;shadowlength,0;x,SCREEN_CENTER_X-210+92-170+64;y,SCREEN_CENTER_Y-68+20;zoom,0.5;diffusealpha,0.7;queuecommand,Cull;"
	CullCommand="%function(self)
	if GAMESTATE:PlayerUsingBothSides(PLAYER_1) then
		self:addx(SCREEN_WIDTH/4-10+ScreenEvaluationDoubleShift(PLAYER_1));
	end
	gnModTrim = SCREENMAN:GetTopScreen():GetChild('PlayerOptionsP1'):GetText();
	gnModTrim = string.gsub(gnModTrim,'-0%% , ','');
	gnModTrim = string.gsub(gnModTrim,'0%% , ','');
	gnModTrim = string.gsub(gnModTrim,'-1%% , ','');
	gnModTrim = string.gsub(gnModTrim,'1%% , ','');
	if setModP1 == nil then setModP1 = 1; end
	if addModP1 == nil then addModP1 = 0; end
	if gnStamina ~= '' then
		gnStamina = ', '..gnStamina..' Stamina'
		end
	FGmod = '';
	if gnFGMod ~= 'Off' then FGmod = ', '..gnFGMod..' FG' end
	if hideBGp1 == 0 then
		hideBGp1 = '';
		else
		hideBGp1 = ', '..hideBGp1..'% Hide BG'
		end
	gnModTrim = gnModTrim..gnStamina..FGmod..hideBGp1
	gnStamina = string.gsub(gnStamina,', ','')
	gnStamina = string.gsub(gnStamina,'Stamina','')
	self:settext(gnModTrim);
		gnModHeight = self:GetHeight();
	end"
	/>
	
	<BitmapText Font="_eurostile normal" Text=""
	Condition="GAMESTATE:IsPlayerEnabled(PLAYER_2)"
	InitCommand="hibernate,0.1;vertalign,top;horizalign,center;WrapWidthPixels,254;shadowlength,0;x,SCREEN_CENTER_X+100+92-170+64;y,SCREEN_CENTER_Y-68+20;zoom,0.5;diffusealpha,0.7;queuecommand,Cull;"
	CullCommand="%function(self)
	if GAMESTATE:PlayerUsingBothSides(PLAYER_2) then
		self:addx(-SCREEN_WIDTH/4+10+ScreenEvaluationDoubleShift(PLAYER_2));
	end
	gnModTrim = SCREENMAN:GetTopScreen():GetChild('PlayerOptionsP2'):GetText();
	gnModTrim = string.gsub(gnModTrim,'0%% , ','');
	gnModTrim = string.gsub(gnModTrim,'-0%% , ','');
	gnModTrim = string.gsub(gnModTrim,'1%% , ','');
	gnModTrim = string.gsub(gnModTrim,'-1%% , ','');
	if setModP2 == nil then setModP2 = 1; end
	if addModP2 == nil then addModP2 = 0; end
	if gnStamina ~= '' then
		gnStamina = ', '..gnStamina..' Stamina'
		end
	FGmod = '';
	if gnFGMod ~= 'Off' then FGmod = ', '..gnFGMod..' FG' end
	if hideBGp2 == 0 then
		hideBGp2 = '';
		else
		hideBGp2 = ', '..hideBGp2..'% Hide BG'
		end
	gnModTrim = gnModTrim..gnStamina..FGmod..hideBGp2
	gnStamina = string.gsub(gnStamina,', ','')
	gnStamina = string.gsub(gnStamina,'Stamina','')
	self:settext(gnModTrim);
		gnModHeight = self:GetHeight();
	end"
	/>	
	
<!--Current Song-->
		<BitmapText
			Text=""
			File="_eurostile blue glow"
			OnCommand="horizalign,center;maxwidth,274;shadowlength,0;zoom,0.75;"
			
			InitCommand="%function(self)
			self:settext(GAMESTATE:GetCurrentSong():GetDisplayMainTitle());
			self:x(SCREEN_CENTER_X);
			self:y(SCREEN_CENTER_Y-172);
			end"
		/>	
		<!-- <BitmapText
			Text=""
			File="_eurostile blue glow"
			OnCommand="horizalign,center;maxwidth,414;shadowlength,0;zoom,0.5;"
			
			InitCommand="%function(self)
			gnVaria = SCREENMAN:GetTopScreen():GetChild('PlayerP1'):GetChild('Judgment'):GetChild('Marvelous'):gettext();
			self:settext(gnVaria);
			self:x(SCREEN_CENTER_X);
			self:y(SCREEN_CENTER_Y-157);
			self:hidden(0);
			end"
		/>	-->
		
	<!--Main BPM Display-->
		<BitmapText
			Text=""
			File="_eurostile blue glow"
			OnCommand="horizalign,center;shadowlength,0;zoom,0.5;"
			
			InitCommand="%function(self)
                            self:x(SCREEN_CENTER_X);
                            self:y(SCREEN_CENTER_Y-146+60+4);

                            local pn = PLAYER_1
                            
                            if GAMESTATE:IsPlayerEnabled(PLAYER_2) then pn = PLAYER_2 end

                            local bpm = DisplayBPM(pn)

                            if GetRateMod() ~= '1.0x' then
								self:settext(bpm .. ' BPM ('..GetRateMod()..' Music Rate) - '..DisplaySongLength());
                            else
                                self:settext(bpm .. ' BPM - '.. DisplaySongLength());
                            end
			end"
		/>

<!--For some reason checking which player is using both sides HERE returns true regardless so enabled-checking is required too-->
<ActorFrame InitCommand="%function(self) self:x(0); self:y(4); 

if GAMESTATE:PlayerUsingBothSides(PLAYER_1) then
	if not GAMESTATE:IsPlayerEnabled(PLAYER_2) then
	self:addx(147); self:addy(-1);
	end
end 

if GAMESTATE:PlayerUsingBothSides(PLAYER_2) then
	if not GAMESTATE:IsPlayerEnabled(PLAYER_1) then
	self:addx(-147); self:addy(-1);
	end	
end

end"><children>
<!--No Card Data-->
	<Layer File="nocard"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and not IsPlayerProfileAvailable(PLAYER_1)"
	OnCommand="@'diffuse,'..FrameColor()..';diffusealpha,1;'"
	InitCommand="%function(self)
			self:x(SCREEN_CENTER_X-225+ScreenEvaluationDoubleShift(PLAYER_1)); self:y(SCREEN_CENTER_Y+68);
			end"	
	/>
	
	<Layer File="nocard"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and not IsPlayerProfileAvailable(PLAYER_2)"
	OnCommand="@'diffuse,'..FrameColor()..';diffusealpha,1;'"
	InitCommand="%function(self)
			self:x(SCREEN_CENTER_X+85+ScreenEvaluationDoubleShift(PLAYER_2)); self:y(SCREEN_CENTER_Y+68);
			end"	
	/>
<!--Avatar-->
	<Layer File="../Graphics/avatars/p1avatar"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	OffCommand="%function(self)
	GlobalOff = 2;
	end"
	InitCommand="%function(self)
			self:x(SCREEN_CENTER_X-255+ScreenEvaluationDoubleShift(PLAYER_1)); self:y(SCREEN_CENTER_Y+50); self:diffusealpha(0); self:zoom(0);
			a1Width = self:GetWidth(); 
			a1Height = self:GetHeight(); 
			if a1Width >= a1Height then 
				self:zoomtowidth(65); 
				self:zoomtoheight(65-1/65); 
				else  
				self:scaletoclipped(65,65); 
				end 
			self:decelerate(0.3);
			self:diffusealpha(1); 
			self:draworder(2); 
			end"	
	/>
	<Layer File="@'../Graphics/NoAvatar/'..getNoAvatar(PLAYER_1)"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	OffCommand="%function(self)
	GlobalOff = 2;
	end"
	NoAvatarCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
			self:x(SCREEN_CENTER_X-255+ScreenEvaluationDoubleShift(PLAYER_1)); self:y(SCREEN_CENTER_Y+50); self:diffusealpha(0); self:zoom(0);
			self:decelerate(0.3);
			self:diffusealpha(1);  
			a1Width = self:GetWidth(); 
			a1Height = self:GetHeight(); 
			if a1Width >= a1Height then 
				self:zoomtowidth(65); 
				self:zoomtoheight(65-1/65); 
				else  
				self:scaletoclipped(65,65); 
				end 
			self:draworder(-500);
			if getNoAvatar(PLAYER_1) == 'p1noavatar.png' then
				self:queuecommand('NoAvatar');
				end
			end"	
	/>
	<Layer File="../Graphics/avatars/p2avatar"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	
	InitCommand="%function(self)
			self:x(SCREEN_CENTER_X+55+ScreenEvaluationDoubleShift(PLAYER_2)); self:y(SCREEN_CENTER_Y+50); self:diffusealpha(0); self:zoom(0);
			a2Width = self:GetWidth(); 
			a2Height = self:GetHeight();
			if a2Width >= a2Height then 
				self:zoomtowidth(65); 
				self:zoomtoheight(65-1/65); 
				else  
				self:scaletoclipped(65,65); 
				end 
			self:decelerate(0.3);
			self:diffusealpha(1);			
			self:draworder(2); 
			end"	
	/>
	
	<Layer File="@'../Graphics/NoAvatar/'..getNoAvatar(PLAYER_2)"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	NoAvatarCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
			self:x(SCREEN_CENTER_X+55+ScreenEvaluationDoubleShift(PLAYER_2)); self:y(SCREEN_CENTER_Y+50); self:diffusealpha(0); self:zoom(0);
			self:decelerate(0.3);
			self:diffusealpha(1);  
			a2Width = self:GetWidth(); 
			a2Height = self:GetHeight();
			if a2Width >= a2Height then 
				self:zoomtowidth(65); 
				self:zoomtoheight(65-1/65); 
				else  
				self:scaletoclipped(65,65); 
				end 
			self:draworder(-500); 
			if getNoAvatar(PLAYER_2) == 'p2noavatar.png' then
				self:queuecommand('NoAvatar');
				end
			end"	
	/>
	
	<Layer File="AvatarFrame.png"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="@'draworder,3;diffuse,'..FrameColor()..';x,SCREEN_CENTER_X-255+'..ScreenEvaluationDoubleShift(PLAYER_1)..';y,SCREEN_CENTER_Y+50;zoomx,1.01;'"
	/>
	<Layer File="AvatarFrame.png"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="@'draworder,3;diffuse,'..FrameColor()..';x,SCREEN_CENTER_X+55+'..ScreenEvaluationDoubleShift(PLAYER_2)..';y,SCREEN_CENTER_Y+50;zoomx,1.01;'"
	/>
<!--Step Artists P1-->
		<BitmapText
			Text=""
			Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and not GAMESTATE:IsCourseMode()"
			File="_eurostile blue glow"
			OnCommand="horizalign,center;maxwidth,200;shadowlength,0;zoom,0.5;queuecommand,Update;"
			
			InitCommand="%function(self)
			self:x(SCREEN_CENTER_X-259-2+49+ScreenEvaluationDoubleShift(PLAYER_1));
			self:y(SCREEN_CENTER_Y-118+53);
			end"
			UpdateCommand="%GetStepsDescriptionText1"
		/>

<!--Step Artists P2-->
		<BitmapText
			Text=""
			Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and not GAMESTATE:IsCourseMode()"
			File="_eurostile blue glow"
			OnCommand="horizalign,center;maxwidth,200;shadowlength,0;zoom,0.5;queuecommand,Update;"
			
			InitCommand="%function(self)
			self:x(SCREEN_CENTER_X+259-111-49+ScreenEvaluationDoubleShift(PLAYER_2));
			self:y(SCREEN_CENTER_Y-118+53);
			end"
			UpdateCommand="%GetStepsDescriptionText2"
		/>		
<!--Everything Else-->
		<ActorFrame
			Condition="GAMESTATE:IsPlayerEnabled(PLAYER_1) and not GAMESTATE:IsCourseMode()"
			OnCommand="x,SCREEN_CENTER_X-250-64;y,SCREEN_CENTER_Y-95+32;difficultyoffset;queuecommand,Go"
			GoCommand="%function(self)
			if GAMESTATE:PlayerUsingBothSides(PLAYER_1) then
				self:addx(-75+ScreenEvaluationDoubleShift(PLAYER_1));
				self:addy(56);
				end
			end"
		> <children>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty pips B')"
				OnCommand="animate,0;playcommand,Update"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_1) end"
			/>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty pips F')"
				OnCommand="@'animate,0;diffuse,'..FrameColor()..';playcommand,Update'"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_1) end"
			/>
			<BitmapText
					Text="@GetCurrentSongDifficulty(PLAYER_1)"
					File="_eurostile normal"
					OnCommand="%function(self) 
					self:hidden(1);
					self:shadowlength(0);
					self:horizalign('center')
					self:zoom(0.5);
					self:x(-12);
					self:y(-1);
					end"
			/>
			<BitmapText
					Text="@GetCurrentSongMeter(PLAYER_1)"
					File="_eurostile normal"
					OnCommand="%function(self) 
					self:shadowlength(0);
					self:horizalign('center')
					self:zoom(0.5);
					self:x(34);
					self:y(-2);
					end"
			/>
		</children> </ActorFrame>
		
		<ActorFrame
			Condition="GAMESTATE:IsPlayerEnabled(PLAYER_1) and GAMESTATE:IsCourseMode()"
			OnCommand="x,SCREEN_CENTER_X-250-4;y,SCREEN_CENTER_Y-95+32;difficultyoffset;queuecommand,Go"
			GoCommand="%function(self)
			if GAMESTATE:PlayerUsingBothSides(PLAYER_1) then
				self:addx(-75+ScreenEvaluationDoubleShift(PLAYER_1));
				self:addy(56);
				end
			end"
		> <children>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty cpips B')"
				OnCommand="animate,0;playcommand,Update"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_1) end"
			/>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty cpips F')"
				OnCommand="@'animate,0;diffuse,'..FrameColor()..';playcommand,Update'"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_1) end"
			/>
					<Actor
				Class="DifficultyMeter"
				Type="ScreenGameplay DifficultyMeterP1"
				OnCommand="x,90-92;y,-1;playcommand,Update"
				UpdateCommand="%function(self) 
						if GAMESTATE:GetCurrentTrail(PLAYER_1) then 
							self:SetFromTrail(GAMESTATE:GetCurrentTrail(PLAYER_1)) 
						else
							self:SetFromSteps(GAMESTATE:GetCurrentSteps(PLAYER_1))
						end
					end"
			/>
		</children> </ActorFrame>
<!-- -->
		<ActorFrame
			Condition="GAMESTATE:IsPlayerEnabled(PLAYER_2) and not GAMESTATE:IsCourseMode()"
			OnCommand="x,SCREEN_CENTER_X+248-252;y,SCREEN_CENTER_Y-95+32;difficultyoffset;queuecommand,Go"
			GoCommand="%function(self)
			if GAMESTATE:PlayerUsingBothSides(PLAYER_2) then
				self:addx(75+ScreenEvaluationDoubleShift(PLAYER_2));
				self:addy(56);
				end
			end"
		> <children>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty pips B')"
				OnCommand="animate,0;playcommand,Update"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_2) end"
			/>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty pips F')"
				OnCommand="@'animate,0;diffuse,'..FrameColor()..';playcommand,Update'"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_2) end"
			/>
			<BitmapText
					Text="@GetCurrentSongDifficulty(PLAYER_2)"
					File="_eurostile normal"
					OnCommand="%function(self) 
					self:shadowlength(0);
					self:horizalign('center')
					self:zoom(0.5);
					self:x(13);
					self:y(-1);
					self:hidden(1);
					end"
			/>
			<BitmapText
					Text="@GetCurrentSongMeter(PLAYER_2)"
					File="_eurostile normal"
					OnCommand="%function(self) 
					self:shadowlength(0);
					self:horizalign('center')
					self:zoom(0.5);
					self:x(-32+66);
					self:y(-2);
					end"
			/>
		</children> </ActorFrame>
		
		<ActorFrame
			Condition="GAMESTATE:IsPlayerEnabled(PLAYER_2) and GAMESTATE:IsCourseMode()"
			OnCommand="x,SCREEN_CENTER_X+248-192;y,SCREEN_CENTER_Y-95+32;difficultyoffset;queuecommand,Go"
			GoCommand="%function(self)
			if GAMESTATE:PlayerUsingBothSides(PLAYER_2) then
				self:addx(75+ScreenEvaluationDoubleShift(PLAYER_2));
				self:addy(56);
				end
			end"
		> <children>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty cpips B')"
				OnCommand="animate,0;playcommand,Update"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_2) end"
			/>
			<Actor
				File="@THEME:GetPath(EC_GRAPHICS,'','_difficulty cpips F')"
				OnCommand="@'animate,0;diffuse,'..FrameColor()..';playcommand,Update'"
				UpdateCommand="%function(self,parent) SetDifficultyFrameFromGameState(self, PLAYER_2) end"
			/>
					<Actor
				Class="DifficultyMeter"
				Type="ScreenGameplay DifficultyMeterP1"
				OnCommand="x,90-92;y,-1;playcommand,Update"
				UpdateCommand="%function(self) 
						if GAMESTATE:GetCurrentTrail(PLAYER_2) then 
							self:SetFromTrail(GAMESTATE:GetCurrentTrail(PLAYER_2)) 
						else
							self:SetFromSteps(GAMESTATE:GetCurrentSteps(PLAYER_2))
						end
					end"
			/>
		</children> </ActorFrame>
</children> </ActorFrame>

		<Layer
			Type="ActorFrame"
			OnCommand='@"x,SCREEN_CENTER_X;y,SCREEN_BOTTOM-61;" .. GetUnlockCommand()'
			>
			<children>
				<BitmapText
					Text="text"
					File="Common Normal"

					UnlockSongCommand="settext,Unlocked a new song!"
					UnlockCourseCommand="settext,Unlocked a new course!"
					UnlockModifierCommand="settext,Unlocked a new modifier!"
					OnCommand="ZoomX,0;sleep,1.0;ZoomY,6;BounceEnd,.3;Zoom,1;sleep,1.6;playcommand,Off"
					
					NoUnlockCommand="hidden,1"
				/>
			</children>
		</Layer>

<!-- Achievements for Player 1-->	
<ActorFrame InitCommand="%function(self)
			self:x(-75+ScreenEvaluationDoubleShift(PLAYER_1));
			self:y(47);
			gnSingleKillP1 = 'no'
			gnDoubleKillP1 = 'no'
			gnTriKillP1 = 'no'
			gnQuadKillP1 = 'no'
			end"
			>
<children>
<!--Singles Level-->
	<BitmapText
	Font="_eurostile normal"
	Text="@GetPlayerStatsAndAwards(PLAYER_1)"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and not GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	self:x(SCREEN_CENTER_X-219+7); self:y(SCREEN_CENTER_Y-219+277); self:diffusealpha(1); 
	self:zoom(0);
	self:decelerate(0.3);
	self:zoom(0.55);
	self:shadowlength(0);
	self:horizalign('left');
	if gnLevelP1 == '[Disabled]' then
		self:hidden(1);
		end
		noEXP1 = 0;
		if gnLevelP1 == nil then
			gnLevelP1 = '[Disabled]';
			self:hidden(1);
			end
		self:settext('Level '..gnLevelP1);
	end"
	/>

<!--Doubles Level-->
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	self:x(SCREEN_CENTER_X-219); self:y(SCREEN_CENTER_Y-219); self:diffusealpha(1); 
	self:zoom(0);
	self:decelerate(0.3);
	self:zoom(0.5);
	self:shadowlength(0);
	self:horizalign('center');
	if gnLevelP1 == '[Disabled]' then
		self:hidden(1);
		end
		noEXP1 = 0;
		if gnLevelP1 == nil then
			gnLevelP1 = '[Disabled]';
			self:hidden(1);
			end
		self:settext('Level '..gnLevelP1);
	end"
	/>

<!--EXP Bars-->
<ActorFrame InitCommand="%function(self) self:x((-75+ScreenEvaluationDoubleShift(PLAYER_1))); self:y(0) end"><children>	
<Layer File="../Graphics/expBar"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="%function(self)
	self:stoptweening();
	self:horizalign('left');
	self:x(SCREEN_CENTER_X-159.5); self:y(SCREEN_CENTER_Y-206+281); self:diffusealpha(1); 
	self:zoom(0);
	self:decelerate(0.3);
	self:zoomtowidth(155);
	self:zoomy(1);
	self:shadowlength(0);
	if gnLevelP1 == '[Disabled]' then
		self:hidden(1);
		end
	end"
	/>
	<Layer File="../Graphics/expMeter"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	OnCommand="@'diffuse,'..LabelColor()..';'"
	InitCommand="%function(self)
	self:stoptweening();
	if gnLevelP1 == '[Disabled]' then
		self:hidden(1);
		end
		if gnPercentageP1 == nil then
			self:stoptweening();
			self:sleep(0.1);
			self:queuecommand('Init');
		else
			self:stoptweening();
		self:draworder(-1000);
		self:x(SCREEN_CENTER_X-136)
		self:y(SCREEN_CENTER_Y-208+281);
		self:horizalign('left');
			self:zoomtowidth(gnPercentageP1*1.37);
			end
	end"
	/>
	
	<Layer File="../Graphics/expBackground"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="%function(self)
		self:stoptweening();
		self:draworder(-1001);
		self:sleep(0.1);
		self:x(SCREEN_CENTER_X-136);
		self:y(SCREEN_CENTER_Y-208+281);
		self:horizalign('left');
		self:zoomtowidth(126);
		self:diffusealpha(0.1);
	if gnLevelP1 == '[Disabled]' then
		self:hidden(1);
		else
		self:sleep(0.1);
		self:queuecommand('Init');
		end
	end"
	/>
</children>
</ActorFrame>


<ActorFrame InitCommand="x,94;y,-24;"><children>	
<!--Achievements P1-->
	<!--Star Count-->
	<Layer File="../Graphics/achievements/achievement0004"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP1 ~= '[Disabled]' then
		if (gnSinglesSingleP1 == nil) or (gnSinglesDoubleP1 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnSinglesSingleP1 == 0) and (gnSinglesDoubleP1 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and not GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';queuecommand,Go'"
	InitCommand="%function(self)
	if gnSinglesSingleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnSinglesSingleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnSinglesSingleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnSinglesDoubleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnSinglesDoubleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnSinglesDoubleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>

	<!--Double Count-->
	<Layer File="../Graphics/achievements/achievement0003"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200+25);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP1 ~= '[Disabled]' then
		if (gnDoublesSingleP1 == nil) or (gnDoublesDoubleP1 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnDoublesSingleP1 == 0) and (gnDoublesDoubleP1 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and not GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnDoublesSingleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnDoublesSingleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+25);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnDoublesSingleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnDoublesDoubleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnDoublesDoubleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+25);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnDoublesDoubleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<!--Tri Count-->
	<Layer File="../Graphics/achievements/achievement0002"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200+50);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP1 ~= '[Disabled]' then
		if (gnTrisSingleP1 == nil) or (gnTrisDoubleP1 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnTrisSingleP1 == 0) and (gnTrisDoubleP1 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and not GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnTrisSingleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnTrisSingleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+50);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnTrisSingleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnTrisDoubleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnTrisDoubleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+50);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnTrisDoubleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<!--Quad Count-->
	<Layer File="../Graphics/achievements/achievement0001"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200+75);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP1 ~= '[Disabled]' then
		if (gnQuadsSingleP1 == nil) or (gnQuadsDoubleP1 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnQuadsSingleP1 == 0) and (gnQuadsDoubleP1 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and not GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnQuadsSingleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnQuadsSingleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+75);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnQuadsSingleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_1) and IsPlayerProfileAvailable(PLAYER_1) and GAMESTATE:PlayerUsingBothSides(PLAYER_1)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_1)..';'"
	InitCommand="%function(self)
	if gnQuadsDoubleP1 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnQuadsDoubleP1);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+75);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnQuadsDoubleP1 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
</children></ActorFrame>	
	
	</children>
</ActorFrame>









<!-- Achievements for Player 2-->	
<ActorFrame InitCommand="%function(self)
			self:x(236+ScreenEvaluationDoubleShift(PLAYER_2));
			self:y(47);
			gnSingleKillP2 = 'no'
			gnDoubleKillP2 = 'no'
			gnTriKillP2 = 'no'
			gnQuadKillP2 = 'no'
			end"
			>
<children>
<!--Singles Level-->
	<BitmapText
	Font="_eurostile normal"
	Text="@GetPlayerStatsAndAwards(PLAYER_2)"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and not GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	self:x(SCREEN_CENTER_X-219+7); self:y(SCREEN_CENTER_Y-219+277); self:diffusealpha(1); 
	self:zoom(0);
	self:decelerate(0.3);
	self:zoom(0.55);
	self:shadowlength(0);
	self:horizalign('left');
	if gnLevelP2 == '[Disabled]' then
		self:hidden(1);
		end
		noEXP2 = 0;
		if gnLevelP2 == nil then
			gnLevelP2 = '[Disabled]';
			self:hidden(1);
			end
		self:settext('Level '..gnLevelP2);
	end"
	/>

<!--Doubles Level-->
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	self:x(SCREEN_CENTER_X-219); self:y(SCREEN_CENTER_Y-219); self:diffusealpha(1); 
	self:zoom(0);
	self:decelerate(0.3);
	self:zoom(0.5);
	self:shadowlength(0);
	self:horizalign('center');
	if gnLevelP2 == '[Disabled]' then
		self:hidden(1);
		end
		noEXP2 = 0;
		if gnLevelP2 == nil then
			gnLevelP2 = '[Disabled]';
			self:hidden(1);
			end
		self:settext('Level '..gnLevelP2);
	end"
	/>

<!--EXP Bars-->
<ActorFrame InitCommand="x,-43;y,0;"><children>	
<Layer File="../Graphics/expBar"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="%function(self)
	self:stoptweening();
	self:horizalign('left');
	self:x(SCREEN_CENTER_X-193); 
	self:y(SCREEN_CENTER_Y-206+281); 
	self:zoom(0);	
	self:decelerate(0.3);
	self:zoomtowidth(155)
	self:zoomy(1);	
	self:shadowlength(0);
	if gnLevelP2 == '[Disabled]' then
		self:hidden(1);
		end
	end"
	/>
	<Layer File="../Graphics/expMeter"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	self:stoptweening();
	if gnLevelP2 == '[Disabled]' then
		self:hidden(1);
		end
		if gnPercentageP2 ~= nil then
			self:stoptweening();
		self:horizalign('left');
		self:draworder(-1000);
		self:x(SCREEN_CENTER_X-169.5);
		self:y(SCREEN_CENTER_Y-208+281);
			self:zoomtowidth(gnPercentageP2*1.37);
			end
	end"
	/>
	
	<Layer File="../Graphics/expBackground"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="%function(self)
		self:stoptweening();
		self:draworder(-1001);
		self:sleep(0.1);
		self:x(SCREEN_CENTER_X-170); 
		self:y(SCREEN_CENTER_Y-208+281);
		self:horizalign('left');
		self:zoomtowidth(126);
		self:diffusealpha(0.1);
	if gnLevelP2 == '[Disabled]' then
		self:hidden(1);
		else
		self:sleep(0.1);
		self:queuecommand('Init');
		end
	end"
	/>
</children>
</ActorFrame>


<ActorFrame InitCommand="x,94;y,-24;"><children>	
<!--Achievements P2-->
	<!--Star Count-->
	<Layer File="../Graphics/achievements/achievement0004"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP2 ~= '[Disabled]' then
		if (gnSinglesSingleP2 == nil) or (gnSinglesDoubleP2 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnSinglesSingleP2 == 0) and (gnSinglesDoubleP2 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and not GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnSinglesSingleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnSinglesSingleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnSinglesSingleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnSinglesDoubleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnSinglesDoubleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnSinglesDoubleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>

	<!--Double Count-->
	<Layer File="../Graphics/achievements/achievement0003"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200+25);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP2 ~= '[Disabled]' then
		if (gnDoublesSingleP2 == nil) or (gnDoublesDoubleP2 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnDoublesSingleP2 == 0) and (gnDoublesDoubleP2 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and not GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnDoublesSingleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnDoublesSingleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+25);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnDoublesSingleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnDoublesDoubleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnDoublesDoubleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+25);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnDoublesDoubleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<!--Tri Count-->
	<Layer File="../Graphics/achievements/achievement0002"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200+50);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP2 ~= '[Disabled]' then
		if (gnTrisSingleP2 == nil) or (gnTrisDoubleP2 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnTrisSingleP2 == 0) and (gnTrisDoubleP2 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and not GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnTrisSingleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnTrisSingleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+50);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnTrisSingleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnTrisDoubleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnTrisDoubleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+50);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnTrisDoubleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<!--Quad Count-->
	<Layer File="../Graphics/achievements/achievement0001"
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2)"
	InitCommand="%function(self)
		self:x(SCREEN_CENTER_X-212-16);
		self:y(SCREEN_CENTER_Y-194+200+75);
		self:zoom(0.85);
		self:diffusealpha(0);
	if gnLevelP2 ~= '[Disabled]' then
		if (gnQuadsSingleP2 == nil) or (gnQuadsDoubleP2 == nil) then
			self:stoptweening();
			self:sleep(0.05);
			self:queuecommand('Init');
			else
			if (gnQuadsSingleP2 == 0) and (gnQuadsDoubleP2 == 0) then
				self:diffusealpha(1);
				else
				self:diffusealpha(1);
				end
			end	
		else
		self:diffusealpha(0);
		end	
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and not GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnQuadsSingleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnQuadsSingleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+75);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnQuadsSingleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
	<BitmapText
	Font="_eurostile normal"
	Text=""
	Condition="GAMESTATE:IsHumanPlayer(PLAYER_2) and IsPlayerProfileAvailable(PLAYER_2) and GAMESTATE:PlayerUsingBothSides(PLAYER_2)"
	OnCommand="@'diffuse,'..PlayerColor(PLAYER_2)..';'"
	InitCommand="%function(self)
	if gnQuadsDoubleP2 == nil then
		self:stoptweening();
		self:sleep(0.05);
		self:queuecommand('Init');
		else
		self:settext(gnQuadsDoubleP2);
		end
	self:draworder(10);
	self:x(SCREEN_CENTER_X-212+31);
	self:y(SCREEN_CENTER_Y-179+186+75);
	self:zoom(0.575);
	self:maxwidth(36);
	self:shadowlength(0);
	self:horizalign('right');
	if gnQuadsDoubleP2 == 0 then
		self:diffusealpha(1);
		else
		self:diffusealpha(1);
		end
	end"
	/>
</children></ActorFrame>	


	</children>
</ActorFrame>	
	<Layer File="OffsetPlot" />	
	<Layer File="_ScreenEvaluation Widgets" />

<!--Screen Transition-->
	<Layer Type="Quad" InitCommand="diffusealpha,0;" ScreenTransitionMessageCommand="%function(self) ScreenTransitionWhoosh('in'); end" />
	
	<Layer Type="Quad"
	OnCommand="x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,1,1,1,0;"
	ScreenTransitionMessageCommand="@'x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;zoomx,SCREEN_WIDTH*2;zoomy,SCREEN_HEIGHT*2;diffuse,1,1,1,1;diffusealpha,0.05;linear,0.1;diffusealpha,0;'"
	/>
	
	<Layer Type="Quad"
	OnCommand="x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,0,0,0,1;linear,0.3;diffusealpha,0;"
	ScreenTransitionMessageCommand="x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,0,0,0,0;linear,0.3;diffusealpha,1;"
	/>
	
	<Layer Type="Quad"
	OnCommand="zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,0,0,0,1;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y+(SCREEN_HEIGHT/2)-50;draworder,30000;decelerate,0.3;diffuse,0,0,0,1;y,SCREEN_CENTER_Y+SCREEN_HEIGHT"
	ScreenTransitionMessageCommand="zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,0,0,0,1;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y+SCREEN_HEIGHT;draworder,30000;accelerate,0.2;diffuse,0,0,0,1;y,SCREEN_CENTER_Y+(SCREEN_HEIGHT/2)"
	/>
	
	<Layer Type="Quad"
	OnCommand="zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,0,0,0,1;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y-(SCREEN_HEIGHT/2);draworder,30000;accelerate,0.2;diffuse,0,0,0,1;y,SCREEN_CENTER_Y-(SCREEN_HEIGHT)"
	ScreenTransitionMessageCommand="zoomx,SCREEN_WIDTH;zoomy,SCREEN_HEIGHT;diffuse,0,0,0,1;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y-SCREEN_HEIGHT;draworder,30000;decelerate,0.2;diffuse,0,0,0,1;y,SCREEN_CENTER_Y-(SCREEN_HEIGHT/2)"
	/>
	
	<Layer File="../Graphics/TransitionArrow"
	OnCommand="hidden,0;vibrate;EffectMagnitude,0.5,0.5,0.1;x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y;draworder,30000;accelerate,0.2;y,SCREEN_CENTER_Y-(SCREEN_HEIGHT/2)-50"
	ScreenTransitionMessageCommand="x,SCREEN_CENTER_X;y,SCREEN_CENTER_Y+SCREEN_HEIGHT+50;draworder,30000;accelerate,0.2;y,SCREEN_CENTER_Y"
	MenuBackMessageCommand="hidden,1;"
	/>
	
	<Layer File="../Graphics/Loading" Condition="not (AllFailed() or IsFinalStage())"
	OnCommand="hidden,0;diffusealpha,0;draworder,30000;x,SCREEN_CENTER_X-1;y,SCREEN_CENTER_Y+65+SCREEN_HEIGHT;"
	ScreenTransitionMessageCommand="accelerate,0.2;diffusealpha,1;y,SCREEN_CENTER_Y+65;"
	MenuBackMessageCommand="hidden,1;"
	/>



	</children>
</ActorFrame>
